# 新しいプログラミング用和文フォントを作る

この記事は進捗 Advent Calendar 2020の22日目の記事です。


日常的にソースコードを編集する人間にとってフォントの選択はとても重要です。
単に文字が表示できれば良いということではなく、より多くの文字を視認性が高く、効率的に表示する必要があります。

ソフトウェアのコードの多くはアルファベットを用いて記述されるため、
必然的にアルファベットに特化したコーディング用フォントは多くのバリエーションがありますが、
仮名や漢字に関しては比較的少ないのが現状です。
フォントに拘りのある人なら多くの日本語の字形情報をもつコーディング用フォントを知っていると思いますが、
自分の理想通りのフォントというのは中々存在しなく、半ば妥協して選択することが多いと思います。

そこで今回は私にとって理想的なフォントを作ることにしました。
それが [Artistic Code Pro](https://github.com/tani/artistic-code-pro) です。このフォントは「ソースコードを華やかに楽しく読む」ことを目的に作りました。
まずフォントの特徴をご紹介します。

## フォントの特徴

### 合字を利用してソースコードが読み易くなる

早速、賛否の別れるポイントですね。そもそもソースコードには二つの操作があります。それは書くことと読むことです。

ソースコードを書いているとき私達が重要視していることは正しく誤字なく文字が入力できることです。
そのため合字機能があると、入力された文字と表示された文字が変化してしまうため、
そのソースコードが正しく入力されたものなのか判断するのが難しくなってしまいます。

一方で、ソースコードを読むとき私達が重要視しているのは、そのソースコードが何を意味しているのか即座に読みとれることです。
この点において、合字はソースコードを読むときに複雑な記号を単純な記号に置き換えることで意味理解を補助してくれます。

以上の二点からフォントに合字を入れることはトレードオフな選択であることが分ります。
ではソースコードの読むのと書くのでは、どちらの時間が長いのでしょうか？
個人差があると思いますが、大半の人間はソースコードを読むことの方が長いのではないでしょうか？
近年、Microsoft や JetBrains などの大手企業からリリースされたフォントは合字機能があるのは、
こういった需要があるからなのではないかと分析しています。

しかし日本語の字形情報のあるコーディング用フォントでは合字機能がないものが、ほとんどです。
そこで私はこの状況を変えるべく、合字をフォントに入れることにしました。

### 絵文字やロゴが使える

すこし前までは絵文字などは機種依存文字としてプログラマからは敬遠される対象でした。
しかし、現在は Unicode による策定もあり日本だけでなく海外でも絵文字が普及してきています。
さらに、一部のプログラマの間ではバージョン管理ツールのコミットメッセージに絵文字を利用し
そのコミットの目的を明確にすることが行なわれてすらいます。

また、端末エミュレータの表示性能の向上もあって Powerline や Starship などで
絵文字や記号を利用したかわいいプロンプトを使うひとも増えてきています。これらは
Unicode に定義されている絵文字以外に Unicode にある私的利用領域として予約されている
名前空間に独自の字形情報と定義することで豊かな表現を可能にしています。

このフォントでは、このような背景を鑑みて主要な絵文字と記号をすべて収録しています。

### TrueType Collection で配布されている

フォントとは本質的に関係ない機能ですが、フォントを配布するとき多くの場合は TrueTypeFont 形式、
または OpenTypeFont 形式のフォントを ZIP 形式のアーカイブでまとめて配布することになります。
しかし、この場合ユーザーはフォントをダウンロードして圧縮ファイルを展開してからフォントをインストールする必要があります。
もし TrueTypeCollection として複数のフォントがひとつのファイルにまとめられているならば、
ユーザーは圧縮ファイルと展開することなくそのフォントをダウンロードして直接フォントをインストールするだけで、
すぐに沢山のフォントが使えるようになります。

## フォントの実装 Artistic Code Pro = "Mgen+" + "Fira Code" + "Nerd Fonts"

フォントをつくるにあたって使用したフォントは以下の通りです。

- Fira Code (英数字、記号、合字)
- Mgen+ 2m (日本語)
- NerdFonts

これらのフォントを FontForge を用いて合成、調整することで作成しています。
Fontforgeはグリフの形を変形させることは可能ですが、フォントのメタデータを編集する機能が不十分なので
そこはFonttoolsという別のライブラリを使用しています。また、TFFからTTCにバンドルするためにはAdobeが公開しているAFDKOを使用しました。
生成方法の詳細はソースコードを直接参照してください。

なおNerd Fontsにある一部のグリフはCC-BY-NC-NDで公開されているため、これらのグリフは除外しています。

## ライセンス

このフォントはオリジナルのフォントに従い、Open Font License 1.1 のもとで配布されています。
各フォントのライセンスにある予約名に加え、Artistic を新たな予約名に追加します。
また生成スクリプトは MIT License のもとで配布されています。
各ライセンス条項の遵守の上でお使いください。

## まとめ

フォントの世界はめまぐるしく進化しています。現在も Variable Font という、パラメータ付きのフォントが開発されはじめています。
多くのフォント作者に感謝しつつも、互換性のためにそういった便利な機能を捨てるのではなく、上手に活用して「華やかで楽しいコードリーディングできる」フォントを目指して、各フォントをリミックスしました。
結果として僕にとって Artistic Code Pro はもっとも便利なフォントとなりましたが、これが、みなさんにとって最適なフォントであるとは限りません。
ぜひ自分だけの良いフォントをつくってみてください。
